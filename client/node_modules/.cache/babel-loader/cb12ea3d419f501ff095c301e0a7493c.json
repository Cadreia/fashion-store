{"ast":null,"code":"import _objectSpread from\"/home/audrey/Documents/REACT/PORTFOLIO/fashion-store/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/home/audrey/Documents/REACT/PORTFOLIO/fashion-store/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/audrey/Documents/REACT/PORTFOLIO/fashion-store/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/audrey/Documents/REACT/PORTFOLIO/fashion-store/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/audrey/Documents/REACT/PORTFOLIO/fashion-store/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/audrey/Documents/REACT/PORTFOLIO/fashion-store/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/home/audrey/Documents/REACT/PORTFOLIO/fashion-store/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect,Component}from\"react\";import\"./App.css\";import HomePage from\"./pages/home/homepage.component\";import{Routes,Route,Navigate}from\"react-router-dom\";import ShopPage from\"./pages/shop/shoppage.component\";import Header from\"./components/header/header.component\";import Auth from\"./pages/auth/auth.component\";import{auth,createUserProfileDocument}from\"./firebase/firebase.utils\";import{onAuthStateChanged,signOut}from\"firebase/auth\";import{onSnapshot}from\"firebase/firestore\";import{connect}from\"react-redux\";import{setCurrentUser as _setCurrentUser}from\"./redux/user/user.actions\";import{createStructuredSelector}from\"reselect\";import{selectCurrentUser}from\"./redux/user/user.selector\";import CheckoutPage from\"./pages/checkout/checkout.component\";import CollectionPage from\"./pages/collection/collection.component\";import CollectionsOverview from\"./components/collections-overview/collections-overview.component\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.unSubscribeFromAuth=null;_this.logUserOut=function(){signOut(auth).then(function(){// Sign-out successful.\n_this.setState({currentUser:null});}).catch(function(error){// An error happened.\nconsole.log(error);});};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var setCurrentUser=this.props.setCurrentUser;this.unSubscribeFromAuth=onAuthStateChanged(auth,/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var userDocRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!user){_context.next=7;break;}_context.next=3;return createUserProfileDocument(user);case 3:userDocRef=_context.sent;// assign current user state the value of the resulting snapshop\nonSnapshot(userDocRef,function(doc){setCurrentUser(_objectSpread({id:doc.id},doc.data()));});_context.next=7;break;case 7:setCurrentUser(user);case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.unSubscribeFromAuth();}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{logUserOut:this.logUserOut}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",element:/*#__PURE__*/_jsx(HomePage,{})}),/*#__PURE__*/_jsxs(Route,{path:\"/shop\",element:/*#__PURE__*/_jsx(ShopPage,{}),children:[/*#__PURE__*/_jsx(Route,{index:true,element:/*#__PURE__*/_jsx(CollectionsOverview,{})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\":collectionId\",element:/*#__PURE__*/_jsx(CollectionPage,{})})]}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/checkout\",element:/*#__PURE__*/_jsx(CheckoutPage,{})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/auth\",element:this.props.currentUser?/*#__PURE__*/_jsx(Navigate,{replace:true,to:\"/\"}):/*#__PURE__*/_jsx(Auth,{})})]})]});}}]);return App;}(Component);var mapStateToProps=createStructuredSelector({currentUser:selectCurrentUser});var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setCurrentUser:function setCurrentUser(user){return dispatch(_setCurrentUser(user));}};};export default connect(mapStateToProps,mapDispatchToProps)(App);","map":{"version":3,"sources":["/home/audrey/Documents/REACT/PORTFOLIO/fashion-store/src/App.js"],"names":["React","useState","useEffect","Component","HomePage","Routes","Route","Navigate","ShopPage","Header","Auth","auth","createUserProfileDocument","onAuthStateChanged","signOut","onSnapshot","connect","setCurrentUser","createStructuredSelector","selectCurrentUser","CheckoutPage","CollectionPage","CollectionsOverview","App","unSubscribeFromAuth","logUserOut","then","setState","currentUser","catch","error","console","log","props","user","userDocRef","doc","id","data","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Component } from \"react\";\nimport \"./App.css\";\nimport HomePage from \"./pages/home/homepage.component\";\nimport { Routes, Route, Navigate } from \"react-router-dom\";\nimport ShopPage from \"./pages/shop/shoppage.component\";\nimport Header from \"./components/header/header.component\";\nimport Auth from \"./pages/auth/auth.component\";\nimport { auth, createUserProfileDocument } from \"./firebase/firebase.utils\";\nimport { onAuthStateChanged, signOut } from \"firebase/auth\";\nimport { onSnapshot } from \"firebase/firestore\";\nimport { connect } from \"react-redux\";\nimport { setCurrentUser } from \"./redux/user/user.actions\";\nimport { createStructuredSelector } from \"reselect\";\nimport { selectCurrentUser } from \"./redux/user/user.selector\";\nimport CheckoutPage from \"./pages/checkout/checkout.component\";\nimport CollectionPage from \"./pages/collection/collection.component\";\nimport CollectionsOverview from \"./components/collections-overview/collections-overview.component\";\n\nclass App extends Component {\n  unSubscribeFromAuth = null;\n\n  componentDidMount() {\n    const { setCurrentUser } = this.props;\n    this.unSubscribeFromAuth = onAuthStateChanged(auth, async (user) => {\n      if (user) {\n        // User is signed in\n        const userDocRef = await createUserProfileDocument(user);\n\n        // assign current user state the value of the resulting snapshop\n        onSnapshot(userDocRef, (doc) => {\n          setCurrentUser({\n            id: doc.id,\n            ...doc.data(),\n          });\n        });\n      } else {\n        // No user is signed in.\n      }\n      setCurrentUser(user);\n    });\n  }\n\n  componentWillUnmount() {\n    this.unSubscribeFromAuth();\n  }\n\n  logUserOut = () => {\n    signOut(auth)\n      .then(() => {\n        // Sign-out successful.\n        this.setState({ currentUser: null });\n      })\n      .catch((error) => {\n        // An error happened.\n        console.log(error);\n      });\n  };\n\n  render() {\n    return (\n      <div>\n        <Header logUserOut={this.logUserOut} />\n        <Routes>\n          <Route exact path=\"/\" element={<HomePage />} />\n          <Route path=\"/shop\" element={<ShopPage />}>\n            <Route index element={<CollectionsOverview />} />\n            <Route exact path=\":collectionId\" element={<CollectionPage />} />\n          </Route>\n          <Route exact path=\"/checkout\" element={<CheckoutPage />} />\n          <Route\n            exact\n            path=\"/auth\"\n            element={\n              this.props.currentUser ? <Navigate replace to=\"/\" /> : <Auth />\n            }\n          />\n          {/* <Route exact path=\"/login\" element={<Login/>}/>\n            <Route exact path=\"/recovery-password\" element={<RecoveryPassword/>}/>\n            <Route path=\"*\" element={<NotFound/>}/> */}\n        </Routes>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = createStructuredSelector({\n  currentUser: selectCurrentUser,\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  setCurrentUser: (user) => dispatch(setCurrentUser(user)),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"]},"metadata":{},"sourceType":"module"}